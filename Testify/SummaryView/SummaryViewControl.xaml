<UserControl 
  x:Class="Leem.Testify.SummaryViewControl"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:local="clr-namespace:Leem.Testify"
  >
  <DockPanel>
    <TextBlock DockPanel.Dock="Bottom" TextWrapping="Wrap" FontSize="12">
      When a top-level item (a Region) is expanded for the first time, its list of States 
      is dynamically loaded.  When a State is expanded for the first time, its Cities are
      loaded.  This deferred loading takes place in the ViewModel classes, and the
      TreeView displays the new objects due to data binding.
    </TextBlock>
    <TreeView ItemsSource="{Binding Modules}">
      <TreeView.ItemContainerStyle>
        <!-- 
        This Style binds a TreeViewItem to a TreeViewItemViewModel. 
        -->
        <Style TargetType="{x:Type TreeViewItem}">
          <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}" />
          <Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}" />
          <Setter Property="FontWeight" Value="Normal" />
          <Style.Triggers>
            <Trigger Property="IsSelected" Value="True">
              <Setter Property="FontWeight" Value="Bold" />
            </Trigger>
          </Style.Triggers>
        </Style>
      </TreeView.ItemContainerStyle>

      <TreeView.Resources>
        <HierarchicalDataTemplate 
          DataType="{x:Type local:ModuleViewModel}" 
          ItemsSource="{Binding Children}"
          >
          <StackPanel Orientation="Horizontal">
            <!--<Image Width="16" Height="16" Margin="3,0" Source="Images\Region.png" />-->
            <TextBlock Text="{Binding ModuleName}" />
                        <StackPanel Orientation="Horizontal">
                            <!--<Image Source="/WpfTutorialSamples;component/Images/group.png" Margin="0,0,5,0" />-->
                         
                            <Grid >
                                <ProgressBar HorizontalAlignment="Right"
		                                 Height="10"
		                                 Margin="10,0,0,0"
		                                 VerticalAlignment="Center"
		                                 Width="100"
		                                 Name="pbCoverage"
                                         Value="{Binding SequenceCoverage, Mode=OneTime}"
		                                 Foreground="Green"
                                         Background="Red"/>
                                <TextBlock Text="{Binding ElementName=pbCoverage, Path=Value, StringFormat={}{0:0}%}" HorizontalAlignment="Center" VerticalAlignment="Center" />
                            </Grid>
                        </StackPanel>
          </StackPanel>
        </HierarchicalDataTemplate>

        <HierarchicalDataTemplate 
          DataType="{x:Type local:ClassViewModel}" 
          ItemsSource="{Binding Children}"
          >
          <StackPanel Orientation="Horizontal">
            <!--<Image Width="16" Height="16" Margin="3,0" Source="Images\State.png" />-->
            <TextBlock Text="{Binding ClassName}" />
                        <StackPanel Orientation="Horizontal">
                            <!--<Image Source="/WpfTutorialSamples;component/Images/group.png" Margin="0,0,5,0" />-->

                            <Grid >
                                <ProgressBar HorizontalAlignment="Right"
		                                 Height="10"
		                                 Margin="10,0,0,0"
		                                 VerticalAlignment="Center"
		                                 Width="100"
		                                 Name="pbCoverage"
                                         Value="{Binding SequenceCoverage, Mode=OneTime}"
		                                 Foreground="Green"
                                         Background="Red"/>
                                <TextBlock Text="{Binding ElementName=pbCoverage, Path=Value, StringFormat={}{0:0}%}" HorizontalAlignment="Center" VerticalAlignment="Center" />
                            </Grid>
                        </StackPanel>
                    </StackPanel>
        </HierarchicalDataTemplate>

        <DataTemplate DataType="{x:Type local:MethodViewModel}">
          <StackPanel Orientation="Horizontal">
            <!--<Image Width="16" Height="16" Margin="3,0" Source="Images\City.png" />-->
            <TextBlock Text="{Binding MethodName}" />
                        <StackPanel Orientation="Horizontal">
                            <!--<Image Source="/WpfTutorialSamples;component/Images/group.png" Margin="0,0,5,0" />-->

                            <Grid >
                                <ProgressBar HorizontalAlignment="Right"
		                                 Height="10"
		                                 Margin="10,0,0,0"
                                             Padding="2,2,2,2"
		                                 VerticalAlignment="Center"
		                                 Width="100"
		                                 Name="pbCoverage"
                                         Value="{Binding SequenceCoverage, Mode=OneTime}"
		                                 Foreground="Green"
                                         Background="Red"/>
                                <TextBlock Text="{Binding ElementName=pbCoverage, Path=Value, StringFormat={}{0:0}%}" HorizontalAlignment="Center" VerticalAlignment="Center" />
                            </Grid>
                        </StackPanel>
                    </StackPanel>
        </DataTemplate>
      </TreeView.Resources>
    </TreeView>
    </DockPanel>
    
</UserControl>